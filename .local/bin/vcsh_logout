#!/usr/bin/env bash

touch "/tmp/out-$(date)"

for repo in `vcsh list`; do
     while read line; do
        filePath="${line#M }"
	message="autoupdate of '${filePath//..\//}'"
        vcsh run "${repo}" git commit "${filePath}" -m "${message}"
    done < <(vcsh status "${repo}")

    # https://github.com/RichiH/vcsh/issues/157
    vcsh run "${repo}" git push -q;
done
